<!DOCTYPE html>
<html>

<head>

	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
	<link rel="shortcut icon" href="Myicon.png" type="image/x-icon">

	<?
		$main_title = '한국 스키장 경영협회';
		include 'db_config.html';
		echo "<title>$main_title / $page</title>";    	
	?>

</head>
<body>
        <div class="ofl_spt">
            <script language="javascript">
                $(document).ready(function() {
                    //메인화면 PC/모바일 분기시 화면 스크롤
                    isOnePageScroll();
                });
            </script>
        </div>
        
		<? include 'link-files.html';
           include"main_nav2.html"  ?>
		<!-- end of Navigation -->

        <div id="scroll_top" >
            <button type="button"><img src="/images/scr_top.jpg"></button>
        </div>
        <div>


<?
	$the_year 	= $_GET["year"];
	$the_category 	= $_GET["category"];

	if($the_year == '' or $the_year < 2018){$the_year = 2018;}
	if (!$the_category){$the_category= '0';}
	
	if ($the_category == '0')
			{	$category_active0 = 'selected';
				$dir 		= "gallery/$the_year/total"; 
				$dir2 		= "gallery/$the_year/total";
			}
	
	if ($the_category == '1')
			{	$category_active1 = 'selected';
				$dir 	= "gallery/$the_year/gallery_1"; 
				$dir2 	= "gallery/$the_year/gallery_1";			
			}

	if ($the_category == '2')
			{	$category_active2 = 'selected';
				$dir 	= "gallery/$the_year/gallery_2"; 
				$dir2 	= "gallery/$the_year/gallery_2";			
			}

	if ($the_category == '3')
			{	$category_active3 = 'selected';
				$dir 	= "gallery/$the_year/gallery_3"; 
				$dir2 	= "gallery/$the_year/gallery_3";			
			}

	if ($the_category == '4')
			{	$category_active4 = 'selected';
				$dir 	= "gallery/$the_year/gallery_4"; 
				$dir2 	= "gallery/$the_year/gallery_4";			
			}

	if ($the_category == '5')
			{	$category_active5 = 'selected';
				$dir 	= "gallery/$the_year/gallery_5"; 
				$dir2 	= "gallery/$the_year/gallery_5";			
			}

	
	
	

?>




            <!-- ㅡㅡㅡㅡㅡㅡㅡㅡ/SB_HEADERㅡㅡㅡㅡㅡㅡㅡㅡ -->
            <div id="sbcenter" class="sb_notice report">
                <div class="sb_top_bg">
                    <div class="inner_wrap">
                       <h2>커뮤니티</h2>
                    </div>
                    <div class="sb_top_menu">
                        <ul class="sbclear">
                            <li><a href="sb_notice.html">공지사항</a></li>
                            <li><a href="sb_safe.html">안전수칙</a></li>
                            <!-- <li><a href="sb_data.html">자료실</a></li> -->
                            <li class="on"><a href='sb_gallery.html'>갤러리</a></li>
                        </ul>
                    </div>
                    <!--/sb_top_menu-->
                </div>
                <!--/sb_top_bg-->
                <div class="sbcenter sb_gallery">
                    <div class="sb_content">
                        <div class="sb_top_text sbclear">
                            <!-- <a href="<?=G5_SKI_URL?>/sb_safe.html" class="sb_prev"><img src="images/sb_prev_btn_on.png" alt="이전"></a> -->
														<a href="sb_safe.html" class="sb_prev"><img src="images/sb_prev_btn_on.png" alt="이전"></a>
                            <h3>갤러리</h3>
                            <a href="#" class="sb_next"><img src="images/sb_next_btn_off.png" alt="다음"></a>
                            <p>한국 스키장 경영협회의 갤러리입니다.<? echo $dir3 ?></p>
                        </div>
<?	
	
	$dh = opendir($dir);
	
	while(false !== ($filename = readdir($dh)))
		{
			$files[] = $filename;
		}
	
	rsort($files); // 오름차순 배열정렬, 내림차순은 rsort()

	// include 'db_config.html';
	$result=mysqli_query($link, $query);
	$row=mysqli_fetch_array($result);
?>


		<style type="text/css">
			@media screen and (max-width: 1140px) {img.card-img-top {height: 320px;object-fit: cover;}}
			@media screen and (min-width: 1140px) {img.card-img-top {width: 1140px;object-fit: cover;}}
			@media screen and (max-width: 768px) 
					{
						div.container {position: relative;width: 100%;padding-right: 0px;padding-left: 0px}
						div.tour_images {position: relative;width: 100%;padding-right: 0px;padding-left: 0px;}
						div.tour_titles {position: relative;width: 100%;padding-right: 5px;padding-left: 15px}
						img.card-img-top {height: 280px;object-fit: cover;}
					}
			@media screen and (max-width: 560px) {
					img.card-img-top {height:260px;object-fit: cover;}
					img.card-img-top2 {width:100%;height:100%px;object-fit: cover;}
					}
			.vertical-center
				{
  				min-height: 100%;  /* Fallback for browsers do NOT support vh unit */
				display: flex;
  				align-items: center;
				}

			.middle_nav {
    			font-family: 'Lato';
				}

			.modal {padding: 0 !important; // override inline padding-right added from js}
			.modal .modal-dialog {
			  	width: 100%;
  				max-width: none;
  				height: 100%;
  				margin: 0;
				}
			.modal .modal-content {
  				height: 100%;
  				border: 0;
  				border-radius: 0;
				}
			.modal .modal-body {
  				overflow-y: auto;
				}
 

</style>

	<body>

  			<div class="container">


<?
//------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+	 					
// 	메인페이지 - 시작
//------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+	 					


		// 페이징
		
		$numrow = count($files)-2;
	
		$page_length = 15;
		$page = $_GET["page"];
		if (!$page)	{$page = 1;}
		$max_page1 = floor($numrow / $page_length);
		$max_page2 = $numrow / $page_length;
		if ($max_page2 > $max_page1)
			{$max_page = $max_page1 + 1;}
		else
		{$max_page = $max_page1;}

		if ($page>$max_page){$page = $max_page;}
		$previous = $page - 1;
		$next = $page + 1;

		if ($next>$max_page){$next = $max_page;}
		if ($previous<1){$previous = 1;}

		$page_start = (($page - 1) * $page_length );
		$page_end = $page_start + $page_length;

		if ($page_end > $numrow) {$page_end = $numrow;}

	echo "
  			<div class='container' style = 'padding:10px;'>
				<select class='form-control' id='selectbox' name='' onchange='javascript:location.href = this.value;'>
	     			<option value='?category=0&year=$the_year' $category_active0>전체</option>
	     			<option value='?category=1&year=$the_year' $category_active1>기선전</option>
   	     			<option value='?category=2&year=$the_year' $category_active2>스키구조요원 시험</option>
	     			<option value='?category=3&year=$the_year' $category_active3>스키지도요원 시험</option>
	     			<option value='?category=4&year=$the_year' $category_active4>해외연수</option>
				</select>
			</div>
			<br>";


?>

		<div class="card-columns">

<?
	// echo $page ,'-',    $Start_no    ,'-',   $End_no , '-',   $page_end   ,'-',$max_page;
	echo $page_start , $page_end;
	for($i = $page_start ; $i < $page_end; $i++)
		{
			echo"
			<div class = 'card row' style = 'border:0;'>
					<a href='#' data-toggle='modal' data-target='#modal_$i'>
						<img src='$dir2/$files[$i]' class = 'rounded card-img-top2' width = 100%></a><br><br>
			</div>			
			<br>			

				<div class='modal fade' id='modal_$i' tabindex='-1' role='dialog' aria-labelledby='tplan_Modal_CenterTitle' aria-hidden='true'>
  					<div class='modal-dialog' role='document'>
    					<div class='modal-content'>
      						<div class='modal-header'>
       							 <h5 class='modal-title text-center' id='tplan_Modal_Long_Title'>제".$round."회 한솔섬유배 아름다운스키 갤러리 ($files[$i])</h5>
        							<button type='button' class='close' data-dismiss='modal' aria-label='Close'>
          							<span aria-hidden='true'>&times;</span>
       								 </button>
      						</div>
      						<div class='modal-body text-center'>
									<a href='#' data-dismiss='modal'><img src='$dir/$files[$i]' heigth=90vh><a>
							</div>
      						<div class='modal-footer'>
        						<button type='button' class='btn btn-dark' data-dismiss='modal'>창닫기</button>
      						</div>
    					</div>
  					</div>
				</div>			

			";
		}
?>  

	</div>

            	            	
          </div>
      </div>
  </div>



<?
echo "
<nav aria-label='...'>
	<ul class='pagination justify-content-center'>";
if ($page >= 4){ 
 	echo "
    	<li class='page-item'>
			<a class='page-link' href='?year=$the_year&category=$the_category&page=$previous'> < </a>
    	</li>";
    	
    	
	echo "   	
		<li class='page-item'>
			<a class='page-link' href='?year=$the_year&category=$the_category&page=1'>1</a>
		</li>
		
	   	<li class='page-item'>
	   	&nbsp;…&nbsp;
		</li>
		";
    }


		// echo $page ,'-',    $Start_no    ,'-',   $End_no , '-',   $page_end   ,'-',$max_page;

$Start_no = $page - 2;
$End_no = $page + 2;
if ($Start_no <= 0){$Start_no = 1;$End_no = 5;}
if ($End_no > $max_page){$End_no = $max_page;}

// echo $Start_no ,'-', $End_no,'-',$page_end,'-',$max_page;

if ($page_end > 11){
	for ($i=$Start_no; $i<$End_no+1; $i++) {

    	if ($page == $i) {
        echo "
    			<li class='page-item active' aria-current='page'>
      				<a class='page-link' href='?year=$the_year&category=$the_category&page=$i'>$i<span class='sr-only'>(current)</span><a>
    			</li>";
		} else {
        echo "
    		   	<li class='page-item'>
    				<a class='page-link' href='?year=$the_year&category=$the_category&page=$i'>$i</a>
    			</li>";
   		 }
 	}
}


if ($page < $max_page - 2){ 

	echo " 
	   	<li class='page-item'>
	   		&nbsp;…&nbsp;
		</li>
	
		<li class='page-item'>
			<a class='page-link' href='?year=$the_year&category=$the_category&page=$max_page'>$max_page</a>
		</li>
		
		";
    }

if ($page_end < $max_page){
    echo "
    	<li class='page-item'>
      		<a class='page-link' href='?year=$the_year&?category=$the_category&page=$next'> > </a>
    	</li>";
}
		echo "
  </ul>
</nav>
</div>
<br><br>";

// echo $page ,'-',    $Start_no    ,'-',   $End_no , '-',   $page_end   ,'-',$max_page;


?>





                        </div><!--/tab_wrap-->
                    </div>
                    <!--/sb_content-->
               </div>
                <!-- //sbcenter -->
<?
          include "include/sb_quick.html";
?>
            </div>
            <!-- //sbcenter -->

            <!-- ㅡㅡㅡㅡㅡㅡㅡㅡFOOTERㅡㅡㅡㅡㅡㅡㅡㅡ -->
            <?
    include "footer.html";
?>
