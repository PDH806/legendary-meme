<!DOCTYPE html>
<html ng-app="liveApp">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
	<link rel="shortcut icon" href="Myicon.png" type="image/x-icon">
    
    <title>회원가입 | 한국스키장경영협회 회원가입</title>
      
		<!-- Custom styles for ski-video.tv -->
		<?
		    include 'db_config.html';
			include 'link-files.html'; 
		?>
		<!-- end of Link -->

  <style>  
  body  
  {  
   margin:0;  
   padding:0;  
  }  
  .box  
  {  
   width:800px;  
   border:1px solid #ccc;  
   background-color:#fff;  
   border-radius:5px;
   margin-top:36px;  
  }  
  </style>  
  
<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular.min.js"></script>
<script type="text/javascript">
function send_code(){
	var userid = document.getElementById("username").value;
	var phone3 = document.getElementById("phone1").value;
	var birth = document.getElementById("date-1").value;
	var member_name3 = document.getElementById("member_name").value;
	var message = member_name3+"님!!! ("+birth+" / "+userid+")\n"+"아래 확인버튼을 클릭하시면 회원가입을 위한 검증번호를 발송해드립니다.";

	if (!userid){
	alert('회원ID를 입력해 주세요 !!!');
	return;
	}

	if (!member_name3){
	alert('이름을 입력해 주세요 !!!');
	return;
	}

	if (!birth){
	alert('생년월일을 입력해 주세요 !!!');
	return;
	}

	if (phone3){
	alert(message);
	}
	else
	{
	alert('전화번호를 입력해 주세요 !!!');
	return;
	}

	$.ajax({
	url  : 'sms/password_change.php',
	data : {
		phone     : phone3,
		id		  : userid,
		name	  : member_name3,
		kind	  : 1,
	},
	type : 'POST',
	success:function(data){
		$("#phone-availability-status").html(data);
		$("#loaderIcon").hide();
	},
		error:function (){}
	});
	}
 	
function send_db(){
	var userid = document.getElementById("username").value;
	var phone3 = document.getElementById("phone1").value;
	var member_name3 = document.getElementById("member_name").value;
	var birth = document.getElementById("date-1").value;
	var email3 = document.getElementById("email").value;
	var code3 = document.getElementById("code").value;

	var pass1 = document.getElementById("pwd1").value;
	var pass2 = document.getElementById("pwd2").value;

	if (!userid){
	alert('회원ID를 입력해 주세요 !!!');
	return;
	}

	if (!member_name3){
	alert('이름을 입력해 주세요 !!!');
	return;
	}

	if (!birth){
	alert('생년월일을 입력해 주세요 !!!');
	return;
	}

	if (!phone3){
	alert('전화번호를 입력해 주세요 !!!');
	return;
	}

	if (!code3){
	alert('전화번호 인증번호를 입력해 주세요 !!!');
	return;
	}

	if (!pass1){
	alert('첫번째 비밀번호를 입력해 주세요 !!!'+code3);
	return;
	}

	if (!pass2){
	alert('두번째 비밀번호를 입력해 주세요 !!!');
	return;
	}

	if (pass2 != pass1){
	alert('비밀번호가 불일치 합니다. !!!');
	return;
	}

	$("#loaderIcon").show();
	jQuery.ajax({
	url: "member_regist.php",
	data : {
		password		: pass1,
		repassword		: pass2,
		member_phone    : phone3,
		member_id		: userid,
		member_name	  	: member_name3,
		member_email	: email3,
		member_birth	: birth,
		code	        : code3,
	},
	type: "POST",
	success:function(data){
		top.document.location.href = 'mypage.html?category=1'
	},
		error:function (){}
	});

}


function check_id(){
	var userid = document.getElementById("username").value;

	if (!userid){
	alert('회원ID를 입력해 주세요 !!!');
	return;
	}

	if (userid){
		url = "check_id.php?userid="+userid;
		window.open(url,"chkid","width=300,height=100");
	}
}
	
function check_code(){
	var userid = document.getElementById("username").value;
	var phone3 = document.getElementById("phone1").value;
	var member_name3 = document.getElementById("member_name").value;
	var email3 = document.getElementById("email").value;
	var code3 = document.getElementById("code").value;
	
		if (!userid){
	alert('회원ID를 입력해 주세요 !!!');
	return;
	}

	if (!member_name3){
	alert('이름을 입력해 주세요 !!!');
	return;
	}

	if (!phone3){
	alert('전화번호를 입력해 주세요 !!!');
	return;
	}

	if (!code3){
	alert('전화번호 인증번호를 입력해 주세요 !!!');
	return;
	}
	
	$("#loaderIcon").show();
	jQuery.ajax({
	url: "check_code.php",
	data : {
		phone           : phone3,
		id		        : userid,
		code	        : code3,
	},
	type: "POST",
	success:function(data){
		$("#code-availability-status").html(data);
		$("#loaderIcon").hide();
	},
		error:function (){}
	});

}
	
</script>

<script type="text/javascript">

  var liveApp = angular.module("liveApp", []); 

  liveApp.controller("repeatCtrl", function ($scope)  
  {  
      $scope.student = {  
          password: "",  
          repeatPassword: ""  
      };  
  });  
  liveApp.directive("compareTo", function ()  
  {  
      return {  
          require: "ngModel",  
          scope:  
          {  
              repeatPassword: "=compareTo"  
          },  
          link: function (scope, element, attributes, paramval)  
          {  
              paramval.$validators.compareTo = function (val)  
              {  
                  return val == scope.repeatPassword;  
              };  
              scope.$watch("repeatPassword", function ()  
              {  
                  paramval.$validate();  
              });  
          }  
      };  
  });  

function check_id2() {
	
	var userid = document.getElementById("username").value;

	if (!userid){
	alert('회원ID를 입력해 주세요 !!!!');
	return;
	}
	
	$("#loaderIcon").show();
	jQuery.ajax({
	url: "check_availability.php",
	data:'username='+$("#username").val(),
	type: "POST",
	success:function(data){
		$("#user-availability-status").html(data);
		$("#loaderIcon").hide();
	},
		error:function (){}
	});
}


</script>

</head>

<body>

		<!-- Navigation for AUGMENT-SKI -->
			<? include 'main-nav.html'; ?>
		<!-- end of Navigation -->

		<br>

        <div id="scroll_top">
            <button type="button"><img src="/images/scr_top.jpg"></button>
        </div>
        
        
		<!-- ㅡㅡㅡㅡㅡㅡㅡㅡ/SB_HEADERㅡㅡㅡㅡㅡㅡㅡㅡ -->
            <div id="sbcenter" class="cp">
                <div class="sb_top_bg">
                    <div class="inner_wrap">
                       <h2>한국스키장경영협회 회원가입</h2>
                    </div>
                    <div class="sb_top_menu">
                        <ul class="sbclear">
                                <li class="on"><a href="">기본정보입력 (1단계)</a></li>
                                <li><a href="#collapseExample" data-bs-toggle="collapse" aria-expanded="false" aria-controls="collapseExample">택배발송용 주소입력 (2단계)</a></li>
                                <li><a href="">사진&생년월일 입력 (3단계)</a></li>
                                <li><a href="">사용장비 입력 (4단계)</a></li>
                                <li><a href="">티칭 라이센스 확인 (최종단계)</a></li>
                        </ul>
                    </div>
            	</div>
			</div>

	<?php

	echo "
<div class = 'container-fluid' style='padding-left:20px;padding-right:20px;'>
	<div class='container'>
	<br><br><br>          
	<div ng-controller='repeatCtrl'>  

		<form  name='liveForm' method=post action='member_regist.php' novalidate='novalidate'>

			<label>&nbsp;❶&nbsp;회원ID</label>
			<div class='input-group'>
				<input class='form-control' type='text' id = 'username' name='member_id' Placeholder='회원 ID (필수)' required>
				  	<div class='input-group-append'>
   						 <button class='btn btn-primary' type='button' onclick='check_id2()' style = 'width:120px;'>ID 중복체크</button>
 					</div>
			</div>
			<span id='user-availability-status' style='font-weight:700;'></span>
			<br>

			<label>&nbsp;❷&nbsp;이름</label>
			<div class='input-group'>
				<input class='form-control' type='text' id = 'member_name' name='member_name' Placeholder='이름 (필수)' requied>
			</div>
			<br>

			<label>&nbsp;❸&nbsp;이메일</label>
			<div class='input-group'>
				<input class='form-control' type='text' id = 'email' name='member_email' Placeholder='이메일 (옵션)'>
			</div>
			<br>
			
			<label>&nbsp;❹&nbsp;생년월일</label>
			<div class='input-group'>
				<input class='form-control' type='date' name='member_birth' id='date-1' placeholder='생년월일 (YYYY-MM-DD)' required>
			</div>
			<br>

			<label>&nbsp;❺&nbsp;전화번호</label>
			<div class='input-group'>
				<input class='form-control' type='text' id='phone1' name='member_phone' Placeholder='전화번호 (예:01012345678)' required>
				  	<div class='input-group-append'>
   						 <button class='btn btn-primary' type='button' onclick='send_code()' style = 'width:120px;'>인증번호 받기</button>
 					</div>
			</div>
			<span id='phone-availability-status' style='font-weight:700;'></span>
			<br>

			<label>&nbsp;❻&nbsp;인증번호</label>
			<div class='input-group'>
				<input class='form-control' type='text' id = 'code' name='code' Placeholder='인증번호 6자리 입력(필수)' required>
					<div class='input-group-append'>
   						 <button class='btn btn-primary' type='button' onclick='check_code()' style = 'width:120px;'>인증번호 검증</button>
 					</div>
			</div>
			<span id='code-availability-status' style='font-weight:700;'></span>
			<br><br><br>";
			
?>

			<div class='input-group'>
  				<div class='input-group-prepend'>
					<button class='btn btn-dark' type='button' style = 'width:120px;'>비밀번호</button>
  				</div>
					<input class='form-control' type='password' id = 'pwd1' name='livePass' ng-model='livePass' placeholder='비밀번호 (영문/숫자/특수문자 8~12자리)' required >  
			</div>
			<br>
			
			<div class='input-group'>
  				<div class='input-group-prepend'>
					<button class='btn btn-dark' type='button' style = 'width:120px;'>비밀번호 확인</button>
  				</div>
					<input class='form-control' type='password' id = 'pwd2' name='repeatPass' ng-model='repeatPass' compare-to='livePass' placeholder='비밀번호 (영문/숫자/특수문자 8~12자리)' required>
			</div>
			<br>

         	<span class='error text-danger' ng-show='liveForm.repeatPass.$error.compareTo'>  
            패스워드가 불일치합니다.  
         	</span>   

			<div class='form-group text-right'>
				<input class='btn btn-success text-uppercase' type='button' value='회원가입' onclick='send_db();'>
			</div>
			
		</form>
	</div>
</div>
</div>

		<br><br><br><br>

<!-- footer for AUGMENT-SKI -->
	<? include 'footer4.html'; ?>
<!-- end of footer -->


</body>

</html>